let readFileSync,writeFileSync,confirm,path,addedScript,notAddedScript,scriptNotFound;_ab9‍.x([["default",()=>checkPackageJson]]);_ab9‍.w("jsonfile",[["readFileSync",["readFileSync"],function(v){readFileSync=v}],["writeFileSync",["writeFileSync"],function(v){writeFileSync=v}]]);_ab9‍.w("node-ask",[["confirm",["confirm"],function(v){confirm=v}]]);_ab9‍.w("path",[["default",["path"],function(v){path=v}]]);_ab9‍.w("../ui/messages/info/addedScript",[["default",["addedScript"],function(v){addedScript=v}]]);_ab9‍.w("../ui/messages/info/notAddedScript",[["default",["notAddedScript"],function(v){notAddedScript=v}]]);_ab9‍.w("../ui/messages/warnings/scriptNotFound",[["default",["scriptNotFound"],function(v){scriptNotFound=v}]]);







const scriptName = 'chromatic';

const findScript = scripts =>
  scripts[scriptName] || Object.values(scripts).find(cmd => cmd.startsWith(scriptName));

               async function checkPackageJson({ log, options }) {
  if (!options.interactive) return;

  try {
    const filename = path.resolve(process.cwd(), './package.json');
    const packageJson = readFileSync(filename);
    if (!packageJson.scripts) packageJson.scripts = {};
    if (findScript(packageJson.scripts)) return;

    const scriptCommand = `${`npx chromatic ${options.originalArgv.slice(2).join(' ')}`
      .replace(/--project-token[= ]\S+/, '')
      .replace(/--app-code[= ]\S+/, '')
      .trim()} --project-token=${options.projectToken}`;

    log.info('');
    if (await confirm(scriptNotFound(scriptName))) {
      packageJson.scripts[scriptName] = scriptCommand;
      writeFileSync(filename, packageJson, { spaces: 2 });
      log.info('');
      log.info(addedScript(scriptName));
    } else {
      log.info('');
      log.info(notAddedScript(scriptName, scriptCommand));
    }
  } catch (e) {
    log.warn(e);
  }
}
